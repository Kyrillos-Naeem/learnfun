<!DOCTYPE html>
<html lang="ar" dir="rtl"> <!-- lang and dir will be updated by JS -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بوابة التعلم الذكي</title> <!-- This will be updated by JS -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7696225868255842" crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-7696225868255842">
    <style>
        :root {
            --bg-dark-primary: #12121B;
            --bg-dark-secondary: #1C1C2F;
            --bg-dark-tertiary: #282844;
            --text-light-primary: #F0F0F8;
            --text-light-secondary: #A0A0C0;
            --accent-primary: #00BFFF; /* DeepSkyBlue */
            --accent-secondary: #009ACD;
            --accent-tertiary: #FFC107; /* Amber */
            --border-color: #38385A;
            --shadow-color-light: rgba(0, 191, 255, 0.25);
            --shadow-color-dark: rgba(0, 0, 0, 0.3);
            --font-ar: 'Cairo', sans-serif;
            --font-en: 'Roboto', sans-serif;
            --border-radius-sm: 6px;
            --border-radius-md: 10px;
            --border-radius-lg: 16px;
            --border-radius-xl: 20px; /* New */
            --transition-fast: 0.2s ease-out;
            --transition-medium: 0.3s ease-out;
            --transition-smooth: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }

        body {
            background: linear-gradient(135deg, var(--bg-dark-primary) 0%, #1A1A2A 100%);
            color: var(--text-light-primary);
            line-height: 1.8;
            font-size: 16px;
            font-family: var(--font-ar), sans-serif; /* Default to AR, JS will update */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- Language Switcher --- */
        .language-switcher-container {
            position: fixed;
            top: 20px;
            right: 20px; 
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px; /* Increased gap */
            background-color: rgba(22, 22, 38, 0.85); /* Slightly darker */
            padding: 8px 14px; /* Increased padding */
            border-radius: var(--border-radius-md);
            box-shadow: 0 4px 15px var(--shadow-color-dark);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: background-color var(--transition-medium);
        }
        .language-switcher-container:hover {
            background-color: rgba(22, 22, 38, 0.98);
        }
        .language-label {
            color: var(--text-light-secondary);
            font-size: 1.2em; /* Slightly larger icon */
            font-weight: 500;
            margin-inline-end: 2px;
            line-height: 1; /* For better vertical alignment */
        }
        #languageSelect {
            background-color: rgba(45, 45, 70, 0.85); /* Slightly adjusted */
            color: var(--text-light-primary);
            border: 1px solid var(--border-color);
            padding: 10px 15px; 
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2300BFFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 0.8em top 50%, 0 0; /* Default LTR */
            background-size: .7em auto, 100%; /* Slightly larger arrow */
            padding-right: 2.8em; /* Default for LTR */
            padding-left: 1em;  /* Default for LTR */
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background-color var(--transition-fast);
        }
        #languageSelect:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--shadow-color-light);
        }
        #languageSelect:hover { background-color: rgba(55, 55, 82, 0.95); }
        #languageSelect option { background-color: var(--bg-dark-tertiary); color: var(--text-light-primary); }


        .app-shell { display: flex; flex-direction: column; flex-grow: 1; }

        .welcome-section {
            position: relative;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 100px 20px 70px 20px; min-height: 65vh; /* Increased padding and min-height */
            background: radial-gradient(circle, rgba(26,26,46,0.85) 0%, rgba(18,18,27,0.95) 70%),
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.07"><path d="M10 10 Q20 0 30 10 T50 10 T70 10 T90 10 M10 30 Q20 20 30 30 T50 30 T70 30 T90 30 M10 50 Q20 40 30 50 T50 50 T70 50 T90 50 M10 70 Q20 60 30 70 T50 70 T70 70 T90 70 M10 90 Q20 80 30 90 T50 90 T70 90 T90 90" stroke="%23009ACD" fill="none" stroke-width="1.2"/></svg>'); /* Updated pattern */
            background-size: cover, 250px; /* Larger pattern */
            animation: fadeInWelcome 1.2s ease-out;
        }
        @keyframes fadeInWelcome { from { opacity: 0; transform: translateY(25px); } to { opacity: 1; transform: translateY(0); } }
        .welcome-section h1 { font-size: 3.8em; font-weight: 700; color: #ffffff; margin-bottom: 25px; letter-spacing: -1.5px; text-shadow: 0 3px 15px var(--shadow-color-dark); }
        .welcome-section .subtitle { font-size: 1.45em; color: var(--text-light-secondary); margin-bottom: 40px; max-width: 650px; }
        .cta-button { 
            background-color: var(--accent-primary); 
            color: #ffffff; 
            padding: 16px 40px; 
            font-size: 1.25em; 
            font-weight: 600; 
            border: none; 
            border-radius: var(--border-radius-md); 
            cursor: pointer; text-decoration: none; 
            transition: background-color var(--transition-medium), transform var(--transition-medium), box-shadow var(--transition-medium); 
            box-shadow: 0 5px 20px rgba(0, 191, 255, 0.35); 
        }
        .cta-button:hover, .cta-button:focus { 
            background-color: var(--accent-secondary); 
            transform: translateY(-4px) scale(1.02); 
            box-shadow: 0 8px 25px rgba(0, 191, 255, 0.45); 
            outline: none;
        }

        .main-content-area {
            width: 90%;
            max-width: 1000px; /* Increased max-width */
            margin: 0 auto 50px auto;
            padding: 35px 40px; /* Increased padding */
            background-color: var(--bg-dark-secondary);
            border-radius: var(--border-radius-xl); /* Larger radius */
            box-shadow: 0 15px 50px var(--shadow-color-dark);
            opacity: 0;
            transform: translateY(30px);
            transition: opacity var(--transition-smooth), transform var(--transition-smooth), margin-top var(--transition-smooth);
        }
        .main-content-area.visible {
            opacity: 1;
            transform: translateY(0);
            margin-top: -100px; /* Adjust for larger welcome section */
        }
        .content-header { text-align: center; margin-bottom: 35px; }
        .content-header h2 { font-size: 2.4em; color: var(--text-light-primary); margin-bottom: 12px; }
        .content-header p { color: var(--text-light-secondary); font-size: 1.15em; }
        
        .search-bar-container {
            position: relative;
            margin-bottom: 35px;
            display: flex;
            align-items: center;
        }
        #mainSearchInput {
            width: 100%;
            padding: 18px 25px 18px 65px; /* Adjusted for icon */
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            background-color: var(--bg-dark-tertiary);
            color: var(--text-light-primary);
            font-size: 1.15em;
            transition: border-color var(--transition-medium), box-shadow var(--transition-medium);
        }
        html[dir="ltr"] #mainSearchInput { padding: 18px 65px 18px 25px; }
        #mainSearchInput:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px var(--shadow-color-light);
        }
        #mainSearchInput::placeholder { color: var(--text-light-secondary); opacity: 0.6; }
        .search-icon-main {
            position: absolute;
            top: 50%;
            right: 22px; /* Adjusted for new padding */
            transform: translateY(-50%);
            color: var(--text-light-secondary);
            font-size: 1.4em; /* For SVG */
            pointer-events: none;
            display: flex; align-items: center;
        }
        html[dir="ltr"] .search-icon-main { right: auto; left: 22px; }
        
        .clear-search-btn {
            position: absolute;
            top: 50%;
            left: 20px; /* Adjusted */
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-light-secondary); /* SVG color */
            font-size: 1.1em; /* For SVG container */
            cursor: pointer;
            display: none; /* JS handles visibility */
            padding: 8px; /* Clickable area */
            line-height: 1;
            border-radius: 50%;
            transition: color var(--transition-fast), background-color var(--transition-fast);
        }
        html[dir="ltr"] .clear-search-btn { left: auto; right: 20px; }
        .clear-search-btn.visible { display: flex; align-items: center; justify-content:center; }
        .clear-search-btn:hover, .clear-search-btn:focus { 
            color: var(--accent-primary); 
            background-color: rgba(255,255,255,0.05);
            outline: none;
        }


        .department-card {
            margin-bottom: 30px;
            border-radius: var(--border-radius-lg); /* Slightly larger radius */
            background-color: var(--bg-dark-tertiary);
            box-shadow: 0 6px 18px rgba(0,0,0,0.25);
            overflow: hidden;
            transition: box-shadow var(--transition-medium), transform var(--transition-medium);
            outline: none;
        }
        .department-card:focus-within, .department-card:hover {
            transform: translateY(-4px) scale(1.005); /* Subtle scale */
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
        }
        .department-header {
            background-image: linear-gradient(to right, var(--bg-dark-secondary), #22223A);
            color: #ffffff;
            padding: 22px 30px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-image var(--transition-medium);
            border-bottom: 1px solid var(--border-color);
            outline: none;
        }
        .department-header:focus, .department-header.active {
            background-image: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
            color: #fff;
        }
        .department-header h3 { margin: 0; font-size: 1.7em; font-weight: 600; display: flex; align-items: center; }
        .department-header h3 .dept-icon { 
            font-size: 1.1em; 
            margin-inline-end: 12px; /* Replaces specific margin-left/right logic in JS */
        }
        .toggle-icon { 
            font-size: 1.5em; /* SVG container */
            transition: transform var(--transition-smooth); 
            color: var(--accent-primary);
            display: inline-flex; 
            align-items: center; 
            justify-content: center;
        }
        .department-header.active .toggle-icon { transform: rotate(180deg); color: #fff; }
        
        .subject-list { list-style: none; padding: 0; margin: 0; max-height: 0; overflow: hidden; transition: max-height var(--transition-smooth), padding var(--transition-smooth); background-color: var(--bg-dark-tertiary); }
        .department-header.active + .subject-list { max-height: 800px; padding: 10px 0; }
        
        .subject-item { 
            padding: 18px 30px; 
            border-top: 1px solid var(--border-color); 
            transition: background-color var(--transition-fast), border-color var(--transition-fast), padding var(--transition-fast);
            /* border-radius: var(--border-radius-sm); No need for radius here as it's inside a list */
            border-left: 3px solid transparent; /* LTR default */
            border-right: 3px solid transparent; /* RTL default */
        }
        html[dir="ltr"] .subject-item:hover, html[dir="ltr"] .subject-item:focus-within { 
            background-color: #2A2A4A; 
            border-left-color: var(--accent-primary);
            padding-left: 27px; /* 30px original - 3px border */
        }
        html[dir="rtl"] .subject-item:hover, html[dir="rtl"] .subject-item:focus-within { 
            background-color: #2A2A4A; 
            border-right-color: var(--accent-primary);
            padding-right: 27px; /* 30px original - 3px border */
        }
        .subject-item:first-child { border-top: none; }
        .subject-item a { color: var(--accent-primary); text-decoration: none; display: flex; align-items: center; font-size: 1.1em; font-weight: 500; transition: color var(--transition-fast); outline: none; }
        .subject-item a:focus, .subject-item a:hover { color: var(--accent-tertiary); text-decoration: underline; }
        .subject-item a .subject-icon { 
            font-size: 1.2em;
            margin-inline-end: 12px; /* Replaces specific margin-left/right logic */
        }
        .subject-item.hidden { display: none; }
        .no-results-message { text-align:center; padding:30px; color:var(--text-light-secondary); font-size:1.15em; }

        .app-footer { text-align: center; padding: 35px 20px; margin-top: auto; background-color: var(--bg-dark-primary); border-top: 1px solid var(--border-color); }
        .app-footer .footer-links {
            margin-bottom: 18px;
            font-size: 0.95em;
        }
        .app-footer .footer-links a {
            color: var(--text-light-secondary);
            text-decoration: none;
            margin: 0 10px; /* Increased margin */
            transition: color var(--transition-fast), text-decoration var(--transition-fast);
        }
        .app-footer .footer-links a:hover,
        .app-footer .footer-links a:focus {
            color: var(--accent-primary);
            text-decoration: underline;
            outline: none; 
        }
        .app-footer .copyright { margin-top: 12px; font-size: 0.9em; color: #707090; }

        .placeholder-page-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-color: rgba(18, 18, 27, 0.9); /* Darker overlay */
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); 
            display: flex; align-items: center; justify-content: center; z-index: 2000; /* Higher z-index */
            opacity: 0; visibility: hidden; 
            transition: opacity var(--transition-medium), visibility var(--transition-medium); 
        }
        .placeholder-page-overlay.visible { opacity: 1; visibility: visible; }
        .placeholder-page-content { 
            background-color: var(--bg-dark-secondary); 
            padding: 35px 45px; /* Increased padding */
            border-radius: var(--border-radius-xl); 
            width: 90%; max-width: 750px; max-height: 85vh; overflow-y: auto; 
            box-shadow: 0 15px 60px var(--shadow-color-dark); 
            position: relative;
            opacity: 0;
            transform: scale(0.95) translateY(15px);
            transition: transform var(--transition-medium) ease-out, opacity var(--transition-medium) ease-out;
        }
        .placeholder-page-overlay.visible .placeholder-page-content { 
            opacity: 1;
            transform: scale(1) translateY(0); 
        }
        .placeholder-page-content h2 { color: var(--text-light-primary); margin-bottom: 25px; font-size: 2em;}
        .placeholder-page-content p, .placeholder-page-content ul { margin-bottom: 18px; line-height: 1.75; }
        .placeholder-page-content ul { padding-right: 20px; } /* RTL default */
        html[dir="ltr"] .placeholder-page-content ul { padding-right: 0; padding-left: 20px; } /* LTR specific */
        .placeholder-page-content a { color: var(--accent-primary); text-decoration: none; font-weight: 500; }
        .placeholder-page-content a:hover { text-decoration: underline; color: var(--accent-tertiary); }
        
        .placeholder-page-content .close-btn {
            background: transparent;
            border: none;
            color: var(--text-light-secondary); /* For SVG */
            font-size: 1.6em; /* SVG container size */
            cursor: pointer;
            position: absolute;
            top: 18px;
            z-index: 10;
            padding: 8px; /* Clickable area */
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: background-color var(--transition-fast), color var(--transition-fast);
        }
        html[dir="ltr"] .placeholder-page-content .close-btn { right: 18px; left: auto; }
        html[dir="rtl"] .placeholder-page-content .close-btn { left: 18px; right: auto; }
        .placeholder-page-content .close-btn:hover { 
            background-color: rgba(255,255,255,0.1); 
            color: var(--text-light-primary);
        }
        .placeholder-page-content .close-btn:focus { 
            outline: 2px solid var(--accent-primary); 
            outline-offset: 2px;
            background-color: rgba(255,255,255,0.08); 
        }

        

    </style>
</head>
<body>
    <div class="app-shell">
        <section class="welcome-section" id="welcome">
            <div class="language-switcher-container">
                <label for="languageSelect" class="language-label" id="languageLabel">🌐</label>
                <select id="languageSelect" aria-labelledby="languageLabel" title="Select language"></select>
            </div>
            <h1 data-translate-key="welcomeTitle"></h1>
            <p class="subtitle" data-translate-key="welcomeSubtitle"></p>
            <a href="#mainContent" class="cta-button" id="startExploringBtn" data-translate-key-text="exploreButton"></a>
        </section>

        <section class="main-content-area" id="mainContent">
            <header class="content-header">
                <h2 data-translate-key="sectionsTitle"></h2>
                <p data-translate-key="sectionsSubtitle"></p>
            </header>
            <div class="search-bar-container">
                <input type="text" id="mainSearchInput" data-translate-key-placeholder="searchInputPlaceholder" aria-label="Search" title="Search" placeholder="...">
                <span class="search-icon-main" id="searchIconContainer"></span>
                <button class="clear-search-btn" id="clearSearchBtn" aria-label="Clear search" title="Clear search" tabindex="0" style="display:none;"></button>
            </div>
            <div id="departmentsListContainer">
                <!-- Departments will be rendered here -->
            </div>
        </section>

        <footer class="app-footer">
            <div class="footer-links">
                <a href="#" onclick="showStaticPage('privacyPolicy'); return false;" data-translate-key-text="linkPrivacyPolicy"></a> |
                <a href="#" onclick="showStaticPage('aboutUs'); return false;" data-translate-key-text="linkAboutUs"></a> |
                <a href="#" onclick="showStaticPage('contactUs'); return false;" data-translate-key-text="linkContactUs"></a> |
                <a href="#" onclick="showStaticPage('termsConditions'); return false;" data-translate-key-text="linkTermsConditions"></a>
            </div>
            <p class="copyright" data-translate-key="copyright"></p>
        </footer>
    </div>

    <div class="placeholder-page-overlay" id="placeholderOverlay">
        <div class="placeholder-page-content" id="placeholderContent">
            <!-- Content will be injected here -->
        </div>
    </div>

    <script>
        // --- SVG Icons ---
        const SVG_ICONS = {
            search: `<svg viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em" aria-hidden="true" focusable="false"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>`,
            clear: `<svg viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em" aria-hidden="true" focusable="false"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>`,
            chevronDown: `<svg viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em" aria-hidden="true" focusable="false"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg>`
        };

        // --- Supported Languages Configuration ---
        const supportedLanguages = {
            ar: { name: "العربية", dir: "rtl", font: "var(--font-ar)" },
            en: { name: "English", dir: "ltr", font: "var(--font-en)" }
        };

        // --- Translations Store (Content remains the same as provided initially) ---
        const translations = {
            ar: {
                pageTitle: "بوابة التعلم الذكي",
                welcomeTitle: "بوابة التعلم الذكي",
                welcomeSubtitle: "مرحباً بك في منصتك المتكاملة لاستكشاف المواد الدراسية وخوض تجارب تعليمية فريدة. ابدأ رحلتك المعرفية الآن!",
                exploreButton: "ابدأ الاستكشاف الآن",
                sectionsTitle: "الأقسام الدراسية",
                sectionsSubtitle: "تصفح الأقسام المختلفة للعثور على المواد التي تهتم بها.",
                searchInputPlaceholder: "ابحث عن مادة أو قسم...",
                copyright: "© 2024 بوابة التعلم الذكي. جميع الحقوق محفوظة.",
                noResults: "عذراً، لم يتم العثور على أقسام أو مواد تطابق بحثك.",
                noSubjects: "لا توجد مواد متاحة حالياً.",
                examModalTitlePrefix: "محاكاة امتحان: ",
                examModalIntro: "أنت على وشك بدء محاكاة امتحان لمادة: ",
                examModalInstructionsTitle: "تعليمات هامة:",
                examModalInstruction1: "تأكد من فهمك لمادة الامتحان جيداً.",
                examModalInstruction2: "خصص وقتاً كافياً دون مقاطعات.",
                examModalInstruction3: "راجع إجاباتك قبل الإنهاء (في الامتحان الفعلي).",
                examModalStartButton: "بدء المحاكاة",
                closeButton: "إغلاق",
                // deptToggleOpen and deptToggleClose are no longer used for icon text
                privacyPolicyTitle: "سياسة الخصوصية",
                privacyPolicyContent: `
                    <p>نحن نهتم بخصوصيتك. توضح سياسة الخصوصية هذه كيف نجمع ونستخدم ونحمي معلوماتك الشخصية عند استخدامك لمنصتنا.</p>
                    <p><strong>المعلومات التي نجمعها:</strong></p>
                    <ul>
                        <li>معلومات التسجيل (إذا توفرت): مثل الاسم، البريد الإلكتروني.</li>
                        <li>بيانات الاستخدام: مثل الصفحات التي تزورها، تفاعلاتك مع المحتوى.</li>
                        <li>معلومات تقنية: مثل عنوان IP، نوع المتصفح، نظام التشغيل.</li>
                    </ul>
                    <p><strong>كيف نستخدم معلوماتك:</strong></p>
                    <ul>
                        <li>لتوفير وتحسين خدماتنا.</li>
                        <li>لتخصيص تجربتك التعليمية.</li>
                        <li>للتواصل معك بشأن التحديثات أو الدعم.</li>
                    </ul>
                    <p><strong>مشاركة المعلومات:</strong></p>
                    <p>نحن لا نبيع أو نؤجر معلوماتك الشخصية لأطراف ثالثة. قد نشارك معلومات مجمعة أو مجهولة المصدر لأغراض التحليل.</p>
                    <p><strong>أمان البيانات:</strong></p>
                    <p>نتخذ تدابير معقولة لحماية معلوماتك، ولكن لا يمكن ضمان الأمان المطلق عبر الإنترنت.</p>
                    <p><strong>التغييرات على هذه السياسة:</strong></p>
                    <p>قد نقوم بتحديث سياسة الخصوصية هذه من وقت لآخر. سنخطرك بأي تغييرات جوهرية.</p>
                    <p><em>آخر تحديث: [أدخل تاريخ اليوم]</em></p>
                `,
                aboutUsTitle: "من نحن",
                aboutUsContent: `
                    <p>بوابة التعلم الذكي هي منصة تعليمية تهدف إلى توفير تجربة تعلم تفاعلية ومرنة للطلاب والمهتمين بالمعرفة.</p>
                    <p><strong>مهمتنا:</strong></p>
                    <p>تمكين المتعلمين من خلال توفير أدوات ومواد تعليمية عالية الجودة، وتشجيع التعلم الذاتي المستمر.</p>
                    <p><strong>رؤيتنا:</strong></p>
                    <p>أن نكون الوجهة الرائدة للتعلم الذكي في المنطقة، والمساهمة في بناء مجتمع معرفي متطور.</p>
                    <p>نحن فريق من المطورين والمعلمين المتحمسين لتقديم أفضل تجربة تعليمية ممكنة.</p>
                `,
                contactUsTitle: "اتصل بنا",
                contactUsContent: `
                    <p>نحن سعداء بتواصلك معنا! إذا كان لديك أي أسئلة أو اقتراحات أو استفسارات، فلا تتردد في الاتصال بنا عبر الطرق التالية:</p>
                    <ul>
                        <li><strong>البريد الإلكتروني:</strong> <a href="mailto:Bebo.naiem13@gmail.com">Bebo.naiem13@gmail.com</a></li>     
                    </ul>
                    <p>يمكنك أيضًا متابعتنا على وسائل التواصل الاجتماعي (روابط افتراضية):</p>
                    <ul>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">فيسبوك</a></li>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">تويتر</a></li>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">لينكدإن</a></li>
                    </ul>
                `,
                termsConditionsTitle: "شروط الاستخدام",
                termsConditionsContent: `
                    <p>مرحبًا بك في بوابة التعلم الذكي. باستخدامك لهذه المنصة، فإنك توافق على الالتزام بالشروط والأحكام التالية:</p>
                    <p><strong>1. القبول بالشروط:</strong></p>
                    <p>يشكل استخدامك للمنصة موافقة كاملة على هذه الشروط. إذا كنت لا توافق على أي جزء من هذه الشروط، فيجب عليك عدم استخدام المنصة.</p>
                    <p><strong>2. استخدام المنصة:</strong></p>
                    <ul>
                        <li>يجب أن تستخدم المنصة لأغراض تعليمية وقانونية فقط.</li>
                        <li>أنت مسؤول عن الحفاظ على سرية أي معلومات تسجيل دخول (إذا توفرت).</li>
                        <li>لا يجوز لك استخدام المنصة بطريقة قد تضر بها أو تعطل خدماتها.</li>
                    </ul>
                    <p><strong>3. المحتوى:</strong></p>
                    <p>جميع المواد التعليمية والمحتوى على المنصة محمية بحقوق النشر والعلامات التجارية. لا يجوز لك نسخ أو توزيع أو تعديل أي محتوى دون إذن صريح.</p>
                    <p><strong>4. إخلاء المسؤولية:</strong></p>
                    <p>يتم توفير المحتوى "كما هو" دون أي ضمانات. نحن لا نضمن دقة أو اكتمال أو ملاءمة المعلومات والمواد الموجودة على المنصة لأي غرض معين.</p>
                    <p><strong>5. تحديد المسؤولية:</strong></p>
                    <p>لن نكون مسؤولين عن أي أضرار مباشرة أو غير مباشرة تنشأ عن استخدامك أو عدم قدرتك على استخدام المنصة.</p>
                    <p><strong>6. التعديلات على الشروط:</strong></p>
                    <p>نحتفظ بالحق في تعديل هذه الشروط في أي وقت. استمرارك في استخدام المنصة بعد أي تعديلات يعني موافقتك على الشروط المعدلة.</p>
                    <p><em>آخر تحديث: [أدخل تاريخ اليوم]</em></p>
                `,
                linkPrivacyPolicy: "سياسة الخصوصية",
                linkAboutUs: "من نحن",
                linkContactUs: "اتصل بنا",
                linkTermsConditions: "شروط الاستخدام"
            },
            en: {
                pageTitle: "Smart Learning Portal",
                welcomeTitle: "Smart Learning Portal",
                welcomeSubtitle: "Welcome to your integrated platform for exploring course materials and engaging in unique learning experiences. Start your knowledge journey now!",
                exploreButton: "Start Exploring Now",
                sectionsTitle: "Academic Departments",
                sectionsSubtitle: "Browse different departments to find the subjects you are interested in.",
                searchInputPlaceholder: "Search for a subject or department...",
                copyright: "© 2024 Smart Learning Portal. All rights reserved.",
                noResults: "Sorry, no departments or subjects found matching your search.",
                noSubjects: "No subjects currently available.",
                examModalTitlePrefix: "Exam Simulation: ",
                examModalIntro: "You are about to start an exam simulation for: ",
                examModalInstructionsTitle: "Important Instructions:",
                examModalInstruction1: "Ensure you understand the exam material well.",
                examModalInstruction2: "Allocate sufficient time without interruptions.",
                examModalInstruction3: "Review your answers before finishing (in a real exam).",
                examModalStartButton: "Start Simulation",
                closeButton: "Close",
                // deptToggleOpen and deptToggleClose are no longer used for icon text
                privacyPolicyTitle: "Privacy Policy",
                privacyPolicyContent: `
                    <p>We care about your privacy. This Privacy Policy explains how we collect, use, and protect your personal information when you use our platform.</p>
                    <p><strong>Information We Collect:</strong></p>
                    <ul>
                        <li>Registration Information (if available): such as name, email.</li>
                        <li>Usage Data: such as pages you visit, your interactions with content.</li>
                        <li>Technical Information: such as IP address, browser type, operating system.</li>
                    </ul>
                    <p><strong>How We Use Your Information:</strong></p>
                    <ul>
                        <li>To provide and improve our services.</li>
                        <li>To personalize your learning experience.</li>
                        <li>To communicate with you about updates or support.</li>
                    </ul>
                    <p><strong>Information Sharing:</strong></p>
                    <p>We do not sell or rent your personal information to third parties. We may share aggregated or anonymized information for analytical purposes.</p>
                    <p><strong>Data Security:</strong></p>
                    <p>We take reasonable measures to protect your information, but no internet transmission can be guaranteed to be 100% secure.</p>
                    <p><strong>Changes to This Policy:</strong></p>
                    <p>We may update this Privacy Policy from time to time. We will notify you of any material changes.</p>
                    <p><em>Last updated: [Enter Today's Date]</em></p>
                `,
                aboutUsTitle: "About Us",
                aboutUsContent: `
                    <p>The Smart Learning Portal is an educational platform aimed at providing an interactive and flexible learning experience for students and knowledge seekers.</p>
                    <p><strong>Our Mission:</strong></p>
                    <p>To empower learners by providing high-quality educational tools and materials, and to encourage continuous self-learning.</p>
                    <p><strong>Our Vision:</strong></p>
                    <p>To be the leading destination for smart learning in the region, and to contribute to building an advanced knowledge-based society.</p>
                    <p>We are a team of developers and educators passionate about delivering the best possible learning experience.</p>
                `,
                contactUsTitle: "Contact Us",
                contactUsContent: `
                    <p>We are happy to hear from you! If you have any questions, suggestions, or inquiries, please do not hesitate to contact us through the following channels:</p>
                    <ul>
                        <li><strong>Email:</strong> <a href="mailto:Bebo.naiem13@gmail.com">Bebo.naiem13@gmail.com</a></li>
                    </ul>
                    <p>You can also follow us on social media (placeholder links):</p>
                    <ul>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">Facebook</a></li>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">Twitter</a></li>
                        <li><a href="#" target="_blank" rel="noopener noreferrer">LinkedIn</a></li>
                    </ul>
                `,
                termsConditionsTitle: "Terms & Conditions",
                termsConditionsContent: `
                    <p>Welcome to the Smart Learning Portal. By using this platform, you agree to comply with and be bound by the following terms and conditions:</p>
                    <p><strong>1. Acceptance of Terms:</strong></p>
                    <p>Your use of the platform constitutes your full acceptance of these terms. If you do not agree with any part of these terms, you must not use the platform.</p>
                    <p><strong>2. Use of the Platform:</strong></p>
                    <ul>
                        <li>You must use the platform for educational and lawful purposes only.</li>
                        <li>You are responsible for maintaining the confidentiality of any login information (if available).</li>
                        <li>You may not use the platform in a way that could damage it or disrupt its services.</li>
                    </ul>
                    <p><strong>3. Content:</strong></p>
                    <p>All educational materials and content on the platform are protected by copyright and trademarks. You may not copy, distribute, or modify any content without explicit permission.</p>
                    <p><strong>4. Disclaimer:</strong></p>
                    <p>The content is provided "as is" without any warranties. We do not guarantee the accuracy, completeness, or suitability of the information and materials on the platform for any particular purpose.</p>
                    <p><strong>5. Limitation of Liability:</strong></p>
                    <p>We will not be liable for any direct or indirect damages arising from your use or inability to use the platform.</p>
                    <p><strong>6. Amendments to Terms:</strong></p>
                    <p>We reserve the right to amend these terms at any time. Your continued use of the platform after any amendments signifies your acceptance of the modified terms.</p>
                    <p><em>Last updated: [Enter Today's Date]</em></p>
                `,
                linkPrivacyPolicy: "Privacy Policy",
                linkAboutUs: "About Us",
                linkContactUs: "Contact Us",
                linkTermsConditions: "Terms & Conditions"
            }
        };

        // --- Department Data (Content remains the same as provided initially) ---
        const departmentsData = [
            {
                id: "cs", icon: "💻",
                name: { ar: "علوم الحاسوب والذكاء الاصطناعي", en: "Computer Science & AI" },
                subjects: [
                    { name: { ar: "مقدمة إلى بايثون والبرمجة الشيئية", en: "Intro to Python & OOP" }, code: "CS101", icon: "🐍" },
                    { name: { ar: "هياكل البيانات المتقدمة والخوارزميات", en: "Advanced Data Structures & Algorithms" }, code: "CS201", icon: "📊" },
                    { name: { ar: "تعلم الآلة وتطبيقاته", en: "Machine Learning & Applications" }, code: "AI305", icon: "🤖" }
                ]
            },
            {
                id: "eng", icon: "⚙️",
                name: { ar: "الهندسة الميكانيكية والطاقة", en: "Mechanical Engineering & Energy" },
                subjects: [
                    { name: { ar: "ديناميكا الموائع والحراريات", en: "Fluid Dynamics & Thermodynamics" }, code: "ME202", icon: "🔥" },
                    { name: { ar: "تصميم الآلات باستخدام CAD/CAM", en: "Machine Design using CAD/CAM" }, code: "ME305", icon: "🔩" }
                ]
            },
            {
                id: "business", icon: "📈",
                name: { ar: "إدارة الأعمال والتسويق الرقمي", en: "Business Admin & Digital Marketing" },
                subjects: [
                    { name: { ar: "استراتيجيات التسويق الرقمي الحديث", en: "Modern Digital Marketing Strategies" }, code: "BUS210", icon: "🌐" },
                    { name: { ar: "ريادة الأعمال وإدارة المشاريع الناشئة", en: "Entrepreneurship & Startup Management" }, code: "BUS405", icon: "🚀" }
                ]
            }
        ];

        // --- DOM Elements ---
        const htmlEl = document.documentElement;
        const bodyEl = document.body;
        const languageSelect = document.getElementById('languageSelect');
        const startExploringBtn = document.getElementById('startExploringBtn');
        const mainContentArea = document.getElementById('mainContent');
        const departmentsListContainer = document.getElementById('departmentsListContainer');
        const mainSearchInput = document.getElementById('mainSearchInput');
        const placeholderOverlay = document.getElementById('placeholderOverlay');
        const placeholderContentDiv = document.getElementById('placeholderContent');
        const clearSearchBtn = document.getElementById('clearSearchBtn');
        const searchIconContainer = document.getElementById('searchIconContainer');


        // --- Language Initialization ---
        let currentLanguage = localStorage.getItem('portalLanguage');

        if (!currentLanguage || !supportedLanguages[currentLanguage]) {
            const browserLangFull = navigator.language || navigator.userLanguage || 'ar'; 
            const browserLangPrimary = browserLangFull.split('-')[0].toLowerCase(); 
            
            if (supportedLanguages[browserLangPrimary]) {
                currentLanguage = browserLangPrimary;
            } else {
                currentLanguage = 'ar'; 
            }
            localStorage.setItem('portalLanguage', currentLanguage);
        }
        
        let departmentsRendered = false;

        // --- Functions ---
        function populateLanguageSelector() {
            languageSelect.innerHTML = ''; 
            Object.keys(supportedLanguages).forEach(langCode => {
                const option = document.createElement('option');
                option.value = langCode;
                option.textContent = supportedLanguages[langCode].name;
                if (langCode === currentLanguage) {
                    option.selected = true;
                }
                languageSelect.appendChild(option);
            });
        }

        function applyTranslations() {
            const langConfig = supportedLanguages[currentLanguage];
            const trans = translations[currentLanguage];

            htmlEl.lang = currentLanguage;
            htmlEl.dir = langConfig.dir;
            bodyEl.style.fontFamily = langConfig.font;
            // bodyEl.className = currentLanguage; // Not strictly needed with dir attribute

            if (langConfig.dir === 'rtl') { 
                languageSelect.style.paddingLeft = '2.8em';
                languageSelect.style.paddingRight = '1em';
                languageSelect.style.backgroundPosition = 'left 0.8em top 50%, 0 0';
            } else { 
                languageSelect.style.paddingRight = '2.8em';
                languageSelect.style.paddingLeft = '1em';
                languageSelect.style.backgroundPosition = 'right 0.8em top 50%, 0 0';
            }

            document.title = trans.pageTitle;

            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                if (trans[key]) el.innerHTML = trans[key];
            });
            document.querySelectorAll('[data-translate-key-text]').forEach(el => {
                const key = el.dataset.translateKeyText;
                if (trans[key]) el.textContent = trans[key];
            });
            document.querySelectorAll('[data-translate-key-placeholder]').forEach(el => {
                const key = el.dataset.translateKeyPlaceholder;
                if (trans[key]) el.placeholder = trans[key];
            });
            
            // Update ARIA labels for dynamically generated content if needed
            clearSearchBtn.setAttribute('aria-label', trans.closeButton || 'Clear search'); // Assuming 'closeButton' can be reused or add a specific one
            clearSearchBtn.setAttribute('title', trans.closeButton || 'Clear search');


            if (departmentsRendered) {
                renderDepartments(); // This will re-render with new language
                if (mainSearchInput.value) filterContent(); // Re-apply filter
            }
        }
        
        function handleLanguageChange(event) {
            currentLanguage = event.target.value;
            localStorage.setItem('portalLanguage', currentLanguage); 
            applyTranslations();
        }

        function updateClearSearchBtn() {
            if (mainSearchInput.value) {
                clearSearchBtn.classList.add('visible');
                clearSearchBtn.style.display = 'flex'; // Changed from block for flex alignment
            } else {
                clearSearchBtn.classList.remove('visible');
                clearSearchBtn.style.display = 'none';
            }
        }

        function renderDepartments(filteredData) {
            const lang = currentLanguage;
            const dataToRender = filteredData || departmentsData;
            // const langConfig = supportedLanguages[lang]; // Not directly used for margin anymore due to margin-inline-end

            departmentsListContainer.innerHTML = '';
            if (dataToRender.length === 0) {
                departmentsListContainer.innerHTML = `<p class="no-results-message">${translations[lang].noResults}</p>`;
                return;
            }

            dataToRender.forEach(dept => {
                const departmentCard = document.createElement('div');
                departmentCard.className = 'department-card';
                departmentCard.tabIndex = 0;
                departmentCard.setAttribute('role', 'region');
                departmentCard.setAttribute('aria-label', dept.name[lang]);

                const headerDiv = document.createElement('div');
                headerDiv.className = 'department-header';
                headerDiv.setAttribute('aria-expanded', 'false');
                headerDiv.setAttribute('aria-controls', `subjects-${dept.id}`);
                headerDiv.tabIndex = 0;
                headerDiv.setAttribute('role', 'button');
                headerDiv.setAttribute('aria-label', `${dept.name[lang]}`); // More specific label
                
                headerDiv.innerHTML = `
                    <h3><span class="dept-icon">${dept.icon || '📚'}</span> ${dept.name[lang]}</h3>
                    <span class="toggle-icon">${SVG_ICONS.chevronDown}</span>
                `;
                
                const subjectListUl = document.createElement('ul');
                subjectListUl.className = 'subject-list';
                subjectListUl.id = `subjects-${dept.id}`;

                if (dept.subjects && dept.subjects.length > 0) {
                    dept.subjects.forEach(subject => {
                        const subjectLi = document.createElement('li');
                        subjectLi.className = 'subject-item';
                        // Storing names for multi-lang search might be complex, rely on current lang search
                        // Or create a concatenated searchable string if needed:
                        // subjectLi.dataset.searchableNames = Object.values(subject.name).join(' ').toLowerCase();
                        subjectLi.innerHTML = `<a href="#exam/${subject.code}" onclick="showExamSimulationPage('${subject.name[lang]}', '${subject.code}'); return false;"><span class="subject-icon">${subject.icon || '📖'}</span>${subject.name[lang]} (${subject.code})</a>`;
                        subjectListUl.appendChild(subjectLi);
                    });
                } else {
                     subjectListUl.innerHTML = `<li class="subject-item no-subjects-item" style="text-align:center; color:var(--text-light-secondary); border-left-color:transparent; border-right-color:transparent;">${translations[lang].noSubjects}</li>`;
                }

                departmentCard.appendChild(headerDiv);
                departmentCard.appendChild(subjectListUl);
                departmentsListContainer.appendChild(departmentCard);

                headerDiv.addEventListener('click', function() {
                    const isActive = this.classList.toggle('active');
                    this.setAttribute('aria-expanded', isActive.toString());
                    // SVG rotation is handled by CSS based on .active class
                });
                headerDiv.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.click();
                    }
                });
            });
            departmentsRendered = true;
        }

        function filterContent() {
            const searchTerm = mainSearchInput.value.toLowerCase().trim();
            const lang = currentLanguage;

            const displayData = departmentsData.map(dept => {
                const deptNameMatches = dept.name[lang].toLowerCase().includes(searchTerm);
                const filteredSubjects = dept.subjects.filter(subject =>
                    `${subject.name[lang].toLowerCase()} ${subject.code.toLowerCase()}`.includes(searchTerm)
                );

                if (deptNameMatches || filteredSubjects.length > 0) {
                    return {
                        ...dept,
                        subjects: (filteredSubjects.length > 0) ? filteredSubjects : (deptNameMatches ? dept.subjects : [])
                    };
                }
                return null;
            }).filter(dept => dept !== null);

            renderDepartments(displayData);

            if (searchTerm) {
                document.querySelectorAll('.department-card').forEach(card => {
                    const header = card.querySelector('.department-header');
                    const subjectList = card.querySelector('.subject-list');
                    if (subjectList && subjectList.children.length > 0 ) {
                         // Check if there are actual subjects, not just the "no subjects" message
                        let hasRealSubjects = false;
                        for(let item of subjectList.children) { 
                            if(item.querySelector('a')) { hasRealSubjects = true; break; } 
                        }
                        if(hasRealSubjects && !header.classList.contains('active')) { 
                            header.classList.add('active'); // Use classList.add instead of click() to avoid multiple event triggers
                            header.setAttribute('aria-expanded', 'true');
                        }
                    }
                });
            }
        }
        
        window.showInfoPage = function(title, contentHTML, closeButtonTextKey = 'closeButton') {
            const lang = currentLanguage;
            const closeButtonLabel = translations[lang][closeButtonTextKey] || "Close";
            placeholderContentDiv.innerHTML = `
                <button class="close-btn" onclick="hideInfoPage()" aria-label="${closeButtonLabel}" title="${closeButtonLabel}" tabindex="0">${SVG_ICONS.clear}</button>
                <h2>${title}</h2>
                <div>${contentHTML}</div>
            `;
            placeholderOverlay.classList.add('visible');
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                const closeBtn = placeholderContentDiv.querySelector('.close-btn');
                if (closeBtn) closeBtn.focus();
            }, 150); // Slightly longer delay for transition
        }

        window.hideInfoPage = function() {
            placeholderOverlay.classList.remove('visible');
            placeholderContentDiv.innerHTML = ''; // Clear content to free resources
            document.body.style.overflow = '';
        }

        window.showExamSimulationPage = function(subjectName, subjectCode) {
            const lang = currentLanguage;
            const trans = translations[lang];
            let exampleParagraph = ""; 
            if (lang === 'ar') exampleParagraph = "<p>هذه واجهة توضيحية. في التطبيق الفعلي، سيتم عرض أسئلة الامتحان هنا.</p>";
            else if (lang === 'en') exampleParagraph = "<p>This is a demonstrative interface. In a real application, exam questions would be displayed here.</p>";

            const examContent = `
                <p>${trans.examModalIntro}<strong>${subjectName} (${subjectCode})</strong>.</p>
                ${exampleParagraph}
                <div style="margin-top: 25px; padding: 20px; border: 1px dashed var(--border-color); border-radius: var(--border-radius-md); background-color: #1f1f35;">
                    <h4>${trans.examModalInstructionsTitle}</h4>
                    <ul>
                        <li>${trans.examModalInstruction1}</li>
                        <li>${trans.examModalInstruction2}</li>
                        <li>${trans.examModalInstruction3}</li>
                    </ul>
                    <button style="margin-top:20px; padding: 12px 25px; background-color: #28a745; color:white; border:none; border-radius:var(--border-radius-sm); cursor:pointer; font-size:1em; transition: background-color var(--transition-fast);">${trans.examModalStartButton}</button>
                </div>
            `;
            // Add hover effect to the start button within the exam simulation
            showInfoPage(`${trans.examModalTitlePrefix}${subjectName}`, examContent);
            setTimeout(() => { // Ensure button exists
                const startSimButton = placeholderContentDiv.querySelector('button[style*="background-color: #28a745"]');
                if(startSimButton) {
                    startSimButton.onmouseover = () => startSimButton.style.backgroundColor = '#218838';
                    startSimButton.onmouseout = () => startSimButton.style.backgroundColor = '#28a745';
                }
            },0);
        }

        window.showStaticPage = function(pageKey) {
            const lang = currentLanguage;
            const trans = translations[lang];
            const titleKey = `${pageKey}Title`;
            const contentKey = `${pageKey}Content`;

            if (trans[titleKey] && trans[contentKey]) {
                const pageTitle = trans[titleKey];
                const today = new Date();
                const formattedDate = lang === 'ar' ? 
                    `${today.getDate()}/${String(today.getMonth() + 1).padStart(2, '0')}/${today.getFullYear()}` : 
                    `${String(today.getMonth() + 1).padStart(2, '0')}/${String(today.getDate()).padStart(2, '0')}/${today.getFullYear()}`;
                
                let pageContent = trans[contentKey];
                pageContent = pageContent.replace(/\[أدخل تاريخ اليوم\]|\[Enter Today's Date\]/gi, formattedDate);

                showInfoPage(pageTitle, pageContent);
            } else {
                console.error(`Translations not found for page: ${pageKey} in language: ${lang}`);
                const errorTitle = translations[lang].errorTitle || (lang === 'ar' ? "خطأ" : "Error");
                const errorContent = translations[lang].errorContent || (lang === 'ar' ? "<p>المحتوى غير متوفر.</p>" : "<p>Content not available.</p>");
                showInfoPage(errorTitle, errorContent);
            }
        }
        
        function initializeIcons() {
            if (searchIconContainer) searchIconContainer.innerHTML = SVG_ICONS.search;
            if (clearSearchBtn) clearSearchBtn.innerHTML = SVG_ICONS.clear;
        }

        // --- Event Listeners ---
        languageSelect.addEventListener('change', handleLanguageChange);

        startExploringBtn.addEventListener('click', (e) => {
            e.preventDefault();
            mainContentArea.classList.add('visible');
            if (!departmentsRendered) renderDepartments(); // Render if not already done
            setTimeout(() => { 
                const targetElement = document.getElementById('mainContent'); // Ensure it targets the right element
                if(targetElement) targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' }); 
            }, 100);
        });

        mainSearchInput.addEventListener('input', function() {
            updateClearSearchBtn();
            filterContent();
        });
        clearSearchBtn.addEventListener('click', function() {
            mainSearchInput.value = '';
            updateClearSearchBtn();
            filterContent();
            mainSearchInput.focus();
        });
        mainSearchInput.addEventListener('focus', updateClearSearchBtn);
        // No blur listener for clear button to prevent it from disappearing before click registers
        
        placeholderOverlay.addEventListener('click', (e) => {
            if (e.target === placeholderOverlay) hideInfoPage();
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && placeholderOverlay.classList.contains('visible')) {
                hideInfoPage();
            }
        });

        // --- Initial Load ---
        initializeIcons();
        populateLanguageSelector(); 
        applyTranslations();      
        updateClearSearchBtn();

    </script>
</body>
</html>
